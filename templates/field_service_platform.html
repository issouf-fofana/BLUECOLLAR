<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Field Service Management Platform - Integrated Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Georgia+Pro:wght@300;400;500;600;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Georgia Pro', Georgia, serif;
        }

        :root {
            --primary-blue: #59ACE1;
            --primary-black: #000000;
            --primary-white: #FFFFFF;
            --primary-orange: #FFB100;
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        body {
            background: var(--primary-white);
            color: var(--primary-black);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Layout Structure */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: var(--header-height);
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-orange) 100%);
            color: var(--primary-white);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .header-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-logo {
            width: 45px;
            height: 45px;
            background: var(--primary-white);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
            font-weight: bold;
            font-size: 18px;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }

        .header-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: var(--sidebar-width);
            height: calc(100vh - var(--header-height));
            background: var(--primary-white);
            border-right: 2px solid var(--primary-blue);
            overflow-y: auto;
            z-index: 100;
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.1);
        }

        .sidebar-menu {
            padding: 2rem 0;
        }

        .menu-section {
            margin-bottom: 2rem;
        }

        .menu-section-title {
            padding: 0 1.5rem 0.5rem;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--primary-black);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 1rem;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            color: var(--primary-black);
            font-size: 0.95rem;
            font-weight: 500;
            position: relative;
        }

        .menu-item:hover {
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-orange));
            color: var(--primary-white);
            transform: translateX(5px);
        }

        .menu-item.active {
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-orange));
            color: var(--primary-white);
            border-right: 4px solid var(--primary-orange);
        }

        .menu-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--primary-orange);
        }

        .menu-icon {
            width: 20px;
            height: 20px;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .menu-text {
            flex: 1;
        }

        .menu-badge {
            background: var(--primary-orange);
            color: var(--primary-white);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            margin-top: var(--header-height);
            flex: 1;
            min-height: calc(100vh - var(--header-height));
            background: #f8fafc;
        }

        .content-area {
            width: 100%;
            height: calc(100vh - var(--header-height));
            overflow: auto;
        }

        .content-panel {
            width: 100%;
            height: 100%;
            background: var(--primary-white);
        }

        /* Module-specific styles */
        .module-content {
            padding: 2rem;
            height: 100%;
            overflow: auto;
        }

        /* Provider cards that can be selected */
        .provider-card {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .provider-card:hover {
            border-color: var(--primary-blue);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .provider-card.active {
            border-color: var(--primary-blue);
            background: rgba(89, 172, 225, 0.05);
            box-shadow: 0 10px 30px rgba(89, 172, 225, 0.2);
        }

        /* Interactive buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            border: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            color: white;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
        }

        .btn-outline:hover {
            background: var(--primary-blue);
            color: white;
        }

        /* Tab system for Call Center */
        .tab-container {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
        }

        .tab {
            flex: 1;
            padding: 1.5rem 2rem;
            background: #f9fafb;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-weight: 600;
            color: #6b7280;
            border: none;
        }

        .tab.active {
            background: white;
            color: var(--primary-blue);
            border-bottom: 3px solid var(--primary-blue);
        }

        .tab:hover:not(.active) {
            background: #f3f4f6;
            color: #374151;
        }

        .tab-content {
            display: none;
            padding: 2rem;
        }

        .tab-content.active {
            display: block;
        }

        /* Status Cards */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
            padding: 2rem;
        }

        .status-card {
            background: var(--primary-white);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .status-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .status-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-black);
        }

        .status-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-white);
        }

        .status-icon.connected {
            background: linear-gradient(45deg, #10b981, #059669);
        }

        .status-icon.disconnected {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }

        .status-icon.warning {
            background: linear-gradient(45deg, var(--primary-orange), #ea580c);
        }

        .status-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: #f8fafc;
            border-radius: 8px;
        }

        .status-label {
            font-weight: 500;
            color: var(--primary-black);
        }

        .status-value {
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status-value.connected {
            color: #10b981;
        }

        .status-value.disconnected {
            color: #ef4444;
        }

        .status-value.warning {
            color: var(--primary-orange);
        }

        /* Welcome Dashboard */
        .welcome-dashboard {
            padding: 2rem;
            text-align: center;
        }

        .welcome-header {
            margin-bottom: 3rem;
        }

        .welcome-title {
            font-size: 3rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            color: #6b7280;
            max-width: 600px;
            margin: 0 auto;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: var(--primary-white);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1rem;
            color: #6b7280;
            font-weight: 500;
        }

        /* Form elements */
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            transition: all 0.2s;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(89, 172, 225, 0.2);
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--primary-white);
            border-radius: 16px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            animation: modalSlideIn 0.3s ease;
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-orange) 100%);
            color: var(--primary-white);
            padding: 1.5rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--primary-white);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 2rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-footer {
            background: #f8fafc;
            padding: 1.5rem 2rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            border-top: 1px solid #e5e7eb;
        }

        /* Form Styles */
        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #f8fafc;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-black);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-blue);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-black);
        }

        .required {
            color: #dc2626;
        }

        .input-group {
            display: flex;
            position: relative;
        }

        .input-group .form-input {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            border-right: none;
            flex: 1;
        }

        .btn-icon {
            background: var(--primary-blue);
            color: var(--primary-white);
            border: 1px solid var(--primary-blue);
            border-left: none;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-icon:hover {
            background: var(--primary-orange);
            border-color: var(--primary-orange);
        }

        /* File Upload Styles */
        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            background: var(--primary-white);
        }

        .file-upload-area:hover {
            border-color: var(--primary-blue);
            background: rgba(89, 172, 225, 0.05);
        }

        .file-upload-area.dragover {
            border-color: var(--primary-orange);
            background: rgba(255, 177, 0, 0.05);
        }

        .file-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .file-upload-content {
            pointer-events: none;
        }

        .file-list {
            margin-top: 1rem;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--primary-white);
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        .file-item:last-child {
            margin-bottom: 0;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .file-icon {
            color: var(--primary-blue);
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 600;
            color: var(--primary-black);
        }

        .file-size {
            font-size: 0.8rem;
            color: #6b7280;
        }

        .file-remove {
            background: #ef4444;
            color: var(--primary-white);
            border: none;
            border-radius: 6px;
            padding: 0.5rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .file-remove:hover {
            background: #dc2626;
        }

        /* Credentials Box */
        .credentials-box {
            background: var(--primary-white);
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 1.5rem;
        }

        /* Checkbox Styles */
        .checkbox-container {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--primary-black);
        }

        .checkbox-container input {
            margin-right: 0.75rem;
            transform: scale(1.2);
            accent-color: var(--primary-blue);
        }

        .checkmark {
            margin-left: 0.5rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            :root {
                --sidebar-width: 260px;
            }
            
            .header-title {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .header {
                padding: 0 1rem;
            }

            .menu-toggle {
                display: block;
                background: none;
                border: none;
                color: var(--primary-white);
                cursor: pointer;
            }
        }

        .menu-toggle {
            display: none;
        }

        /* Loading States */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: 1.1rem;
            color: var(--primary-black);
        }

        .spinner {
            animation: spin 1s linear infinite;
            margin-right: 0.5rem;
        }

        /* Animations */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .status-connected {
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
        }

        .status-disconnected {
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-brand">
            <button class="menu-toggle" onclick="toggleSidebar()">
                <i data-lucide="menu" style="width: 24px; height: 24px;"></i>
            </button>
            <div class="header-logo">FS</div>
            <h1 class="header-title">Field Service Management Platform</h1>
        </div>
        <div class="header-user">
            <div class="user-badge">
                <i data-lucide="shield-check" style="width: 16px; height: 16px; margin-right: 0.5rem;"></i>
                SOC 2 Compliant • Enterprise Ready
            </div>
            <button onclick="logout()" style="background: none; border: none; color: white; cursor: pointer;">
                <i data-lucide="log-out" style="width: 20px; height: 20px;"></i>
            </button>
        </div>
    </header>

    <div class="dashboard-container">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-menu">
                <!-- Core Modules -->
                <div class="menu-section">
                    <div class="menu-section-title">Core Modules</div>
                    <button class="menu-item" onclick="loadContent('field-service')" data-content="field-service">
                        <i data-lucide="wrench" class="menu-icon"></i>
                        <span class="menu-text">Field Service Management</span>
                    </button>
                    <button class="menu-item" onclick="loadContent('work-order')" data-content="work-order">
                        <i data-lucide="file-text" class="menu-icon"></i>
                        <span class="menu-text">Work Order Integration</span>
                    </button>
                    <button class="menu-item" onclick="loadContent('warranty')" data-content="warranty">
                        <i data-lucide="shield" class="menu-icon"></i>
                        <span class="menu-text">Warranty Processing</span>
                    </button>
                    <button class="menu-item" onclick="loadContent('call-center')" data-content="call-center">
                        <i data-lucide="headphones" class="menu-icon"></i>
                        <span class="menu-text">Answering Service Agent</span>
                    </button>
                </div>

                <!-- System Management -->
                <div class="menu-section">
                    <div class="menu-section-title">System Management</div>
                    <button class="menu-item" onclick="loadContent('system-status')" data-content="system-status">
                        <i data-lucide="activity" class="menu-icon"></i>
                        <span class="menu-text">System Status</span>
                        <span class="menu-badge" id="status-badge">5</span>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="content-area">
                <!-- Welcome Dashboard (Default View) -->
                <div id="welcome-content" class="content-panel">
                    <div class="welcome-dashboard">
                        <div class="welcome-header">
                            <h2 class="welcome-title">Welcome to Field Service Platform</h2>
                            <p class="welcome-subtitle">
                                Comprehensive field service management with integrated work order processing, 
                                warranty management, and real-time system monitoring.
                            </p>
                        </div>

                        <div class="stats-overview">
                            <div class="stat-card">
                                <div class="stat-number" id="total-tickets">247</div>
                                <div class="stat-label">Total Tickets Today</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="active-jobs">18</div>
                                <div class="stat-label">Active Jobs</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="completion-rate">94.2%</div>
                                <div class="stat-label">Completion Rate</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="system-uptime">99.8%</div>
                                <div class="stat-label">System Uptime</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Field Service Management Content -->
                <div id="field-service-content" class="content-panel hidden">
                    <div class="module-content">
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <h2 style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin-bottom: 0.5rem;">Field Service Contractor Integration</h2>
                            <p style="color: #6b7280; font-size: 1.1rem;">Connect with leading field service management platforms</p>
                        </div>

                        <!-- Provider Grid -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                            <div class="provider-card" onclick="selectFieldServiceProvider('servicefusion')" data-provider="servicefusion">
                                <div style="width: 60px; height: 60px; margin: 0 auto 1rem; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">SF</div>
                                <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary-black);">Service Fusion</h4>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Complete field service management solution</p>
                                <div id="sf-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(16, 185, 129, 0.1); color: #10b981;">Connected</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectFieldServiceProvider('servicetitan')" data-provider="servicetitan">
                                <div style="width: 60px; height: 60px; margin: 0 auto 1rem; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 14px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">ST</div>
                                <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary-black);">Service Titan</h4>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Trade business management platform</p>
                                <div id="st-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(100, 116, 139, 0.1); color: #6b7280;">Not Connected</div>
                            </div>

                            <div class="provider-card" onclick="selectFieldServiceProvider('roopairs')" data-provider="roopairs">
                                <div style="width: 60px; height: 60px; margin: 0 auto 1rem; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 14px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">RP</div>
                                <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary-black);">Roopairs</h4>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Roofing contractor management system</p>
                                <div id="rp-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(100, 116, 139, 0.1); color: #6b7280;">Not Connected</div>
                            </div>
                        </div>

                        <!-- Configuration Panel -->
                        <div style="background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <div style="padding: 2rem; border-bottom: 1px solid #e5e7eb; background: #f8fafc;">
                                <h3 id="fs-config-title" style="font-size: 1.5rem; color: var(--primary-black); margin-bottom: 1rem;">Service Fusion Integration Configuration</h3>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span id="fs-config-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.9rem; font-weight: 600; background: rgba(16, 185, 129, 0.1); color: #10b981;">● Connected</span>
                                    <button class="btn btn-success" onclick="testFieldServiceConnection()">
                                        <i data-lucide="wifi" style="width: 1rem; height: 1rem;"></i>
                                        Test Connection
                                    </button>
                                </div>
                            </div>
                            
                            <div style="padding: 2rem;">
                                <div style="display: grid; gap: 1.5rem; max-width: 600px;">
                                    <div>
                                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">API Key</label>
                                        <input type="password" id="fs-api-key" class="form-input" value="***************" placeholder="Enter your API key">
                                    </div>
                                    <div>
                                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Base URL</label>
                                        <input type="url" id="fs-base-url" class="form-input" value="https://api.servicefusion.com/v1">
                                    </div>
                                    <div>
                                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Sync Frequency</label>
                                        <select id="fs-sync-freq" class="form-select">
                                            <option value="5">Every 5 minutes</option>
                                            <option value="15" selected>Every 15 minutes</option>
                                            <option value="30">Every 30 minutes</option>
                                            <option value="60">Every hour</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                                    <button class="btn btn-primary" onclick="saveFieldServiceConfig()">Save Configuration</button>
                                    <button class="btn btn-success" onclick="syncFieldServiceNow()">Sync Now</button>
                                    <button class="btn btn-outline" onclick="viewFieldServiceLogs()">View Logs</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Work Order Integration Content -->
                <div id="work-order-content" class="content-panel hidden">
                    <div class="module-content">
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <h2 style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin-bottom: 0.5rem;">Work Order Integration Management</h2>
                            <p style="color: #6b7280; font-size: 1.1rem;">Connect with third-party service management systems</p>
                        </div>

                        <!-- Provider Grid -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                            <div class="provider-card active" onclick="selectWorkOrderProvider('ecotrak')" data-provider="ecotrak">
                                <div style="width: 60px; height: 60px; margin: 0 auto 1rem; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">ECO</div>
                                <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary-black);">Ecotrak</h4>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Field Service Management</p>
                                <div id="eco-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(16, 185, 129, 0.1); color: #10b981;">Connected</div>
                            </div>
                            
                            <div class="provider-card" onclick="selectWorkOrderProvider('servicechannel')" data-provider="servicechannel">
                                <div style="width: 60px; height: 60px; margin: 0 auto 1rem; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">SVC</div>
                                <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary-black);">Service Channel</h4>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Facility Management</p>
                                <div id="svc-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(100, 116, 139, 0.1); color: #6b7280;">Not Connected</div>
                            </div>

                            <div class="provider-card" onclick="selectWorkOrderProvider('corrigo')" data-provider="corrigo">
                                <div style="width: 60px; height: 60px; margin: 0 auto 1rem; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; font-size: 14px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">COR</div>
                                <h4 style="font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary-black);">Corrigo</h4>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Work Order Management</p>
                                <div id="cor-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.8rem; font-weight: 600; background: rgba(100, 116, 139, 0.1); color: #6b7280;">Not Connected</div>
                            </div>
                        </div>

                        <!-- Configuration Panel -->
                        <div style="background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <div style="padding: 2rem; border-bottom: 1px solid #e5e7eb; background: #f8fafc;">
                                <h3 id="wo-config-title" style="font-size: 1.5rem; color: var(--primary-black); margin-bottom: 1rem;">Ecotrak Integration Configuration</h3>
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <span id="wo-config-status" style="padding: 0.5rem 1rem; border-radius: 12px; font-size: 0.9rem; font-weight: 600; background: rgba(16, 185, 129, 0.1); color: #10b981;">● Connected</span>
                                    <button class="btn btn-success" onclick="testWorkOrderConnection()">
                                        <i data-lucide="wifi" style="width: 1rem; height: 1rem;"></i>
                                        Test Connection
                                    </button>
                                </div>
                            </div>
                            
                            <div style="padding: 2rem;">
                                <div style="display: grid; gap: 1.5rem; max-width: 600px;">
                                    <div>
                                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">API Key</label>
                                        <input type="password" id="wo-api-key" class="form-input" value="***************" placeholder="Enter your API key">
                                    </div>
                                    <div>
                                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Base URL</label>
                                        <input type="url" id="wo-base-url" class="form-input" value="https://api.ecotrak.com/v1">
                                    </div>
                                    <div>
                                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Sync Frequency</label>
                                        <select id="wo-sync-freq" class="form-select">
                                            <option value="5">Every 5 minutes</option>
                                            <option value="15" selected>Every 15 minutes</option>
                                            <option value="30">Every 30 minutes</option>
                                            <option value="60">Every hour</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                                    <button class="btn btn-primary" onclick="saveWorkOrderConfig()">Save Configuration</button>
                                    <button class="btn btn-success" onclick="syncWorkOrderNow()">Sync Now</button>
                                    <button class="btn btn-outline" onclick="viewWorkOrderLogs()">View Logs</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Warranty Processing Content -->
                <div id="warranty-content" class="content-panel hidden">
                    <div class="module-content">
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <h2 style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin-bottom: 0.5rem;">Warranty Partner Portal</h2>
                            <p style="color: #6b7280; font-size: 1.1rem;">Select your warranty company to access work order management and tracking</p>
                        </div>

                        <!-- Add Provider Button -->
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <button class="btn btn-primary" onclick="openProviderModal()" style="font-size: 1.1rem; padding: 0.75rem 2rem;">
                                <i data-lucide="plus-circle" style="width: 1.25rem; height: 1.25rem;"></i>
                                Add Provider
                            </button>
                        </div>

                        <!-- Warranty Partner Tiles -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                            <div class="provider-card" onclick="selectWarrantyCompany('newco')" data-company="newco">
                                <div style="display: inline-flex; align-items: center; justify-content: center; width: 4rem; height: 4rem; background: linear-gradient(45deg, var(--primary-blue), var(--primary-orange)); border-radius: 1rem; margin-bottom: 1.5rem;">
                                    <i data-lucide="shield" style="width: 2rem; height: 2rem; color: white;"></i>
                                </div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">NewCo Warranty</h3>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Click to access portal</p>
                                <div style="background: #f8fafc; border-radius: 12px; padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Work Orders</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">12</p>
                                        </div>
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Active</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">8</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="provider-card" onclick="selectWarrantyCompany('nsc')" data-company="nsc">
                                <div style="display: inline-flex; align-items: center; justify-content: center; width: 4rem; height: 4rem; background: linear-gradient(45deg, #16a34a, #15803d); border-radius: 1rem; margin-bottom: 1.5rem;">
                                    <i data-lucide="settings" style="width: 2rem; height: 2rem; color: white;"></i>
                                </div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">NSC</h3>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Click to access portal</p>
                                <div style="background: #f8fafc; border-radius: 12px; padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Work Orders</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">8</p>
                                        </div>
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Active</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">5</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="provider-card" onclick="selectWarrantyCompany('true')" data-company="true">
                                <div style="display: inline-flex; align-items: center; justify-content: center; width: 4rem; height: 4rem; background: linear-gradient(45deg, #9333ea, #7c3aed); border-radius: 1rem; margin-bottom: 1.5rem;">
                                    <i data-lucide="check-circle" style="width: 2rem; height: 2rem; color: white;"></i>
                                </div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">True</h3>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Click to access portal</p>
                                <div style="background: #f8fafc; border-radius: 12px; padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Work Orders</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">15</p>
                                        </div>
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Active</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">9</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="provider-card" onclick="selectWarrantyCompany('spaceman')" data-company="spaceman">
                                <div style="display: inline-flex; align-items: center; justify-content: center; width: 4rem; height: 4rem; background: linear-gradient(45deg, #4f46e5, #4338ca); border-radius: 1rem; margin-bottom: 1.5rem;">
                                    <i data-lucide="zap" style="width: 2rem; height: 2rem; color: white;"></i>
                                </div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">SpaceMan</h3>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Click to access portal</p>
                                <div style="background: #f8fafc; border-radius: 12px; padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Work Orders</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">6</p>
                                        </div>
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Active</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">3</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="provider-card" onclick="selectWarrantyCompany('dukers')" data-company="dukers">
                                <div style="display: inline-flex; align-items: center; justify-content: center; width: 4rem; height: 4rem; background: linear-gradient(45deg, var(--primary-orange), #ea580c); border-radius: 1rem; margin-bottom: 1.5rem;">
                                    <i data-lucide="wrench" style="width: 2rem; height: 2rem; color: white;"></i>
                                </div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">Dukers Warranty</h3>
                                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Click to access portal</p>
                                <div style="background: #f8fafc; border-radius: 12px; padding: 1rem;">
                                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Work Orders</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">10</p>
                                        </div>
                                        <div>
                                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Active</p>
                                            <p style="font-weight: 700; color: var(--primary-black);">6</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Selected Company Actions -->
                        <div id="warranty-actions" style="background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); padding: 2rem; text-align: center; display: none;">
                            <h3 id="selected-company-name" style="color: var(--primary-black); font-weight: 700; margin-bottom: 1rem; font-size: 1.5rem;">NewCo Warranty Portal</h3>
                            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                                <button class="btn btn-primary" onclick="createWorkOrder()">
                                    <i data-lucide="plus" style="width: 1rem; height: 1rem;"></i>
                                    Create Work Order
                                </button>
                                <button class="btn btn-outline" onclick="uploadPDF()">
                                    <i data-lucide="upload" style="width: 1rem; height: 1rem;"></i>
                                    Upload PDF
                                </button>
                                <button class="btn btn-outline" onclick="viewWorkOrders()">
                                    <i data-lucide="list" style="width: 1rem; height: 1rem;"></i>
                                    View Work Orders
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Call Center Content -->
                <div id="call-center-content" class="content-panel hidden">
                    <div class="module-content">
                        <div style="text-align: center; margin-bottom: 2rem;">
                            <h2 style="font-size: 2rem; font-weight: 700; color: var(--primary-blue); margin-bottom: 0.5rem;">Call Center Work Order System</h2>
                            <p style="color: #6b7280; font-size: 1.1rem;">Streamlined work order submission for client service requests</p>
                        </div>

                        <!-- Operator Information -->
                        <div style="background: linear-gradient(45deg, #ecfdf5, #d1fae5); border: 1px solid #86efac; border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem; display: flex; align-items: center; gap: 1rem;">
                            <div style="background: #059669; color: white; padding: 0.5rem 1rem; border-radius: 8px; font-weight: 600; font-size: 0.875rem;">
                                <i data-lucide="user-check" style="width: 1rem; height: 1rem; margin-right: 0.5rem;"></i>
                                Call Center Agent
                            </div>
                            <div>
                                <strong>Operator ID:</strong> <span id="operator-id">OP-A7B3C9</span> |
                                <strong>Session:</strong> <span id="session-id">SS-892341</span> |
                                <strong>Date:</strong> <span id="current-date"></span>
                            </div>
                        </div>

                        <!-- Main Form Tabs -->
                        <div style="background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); overflow: hidden;">
                            <!-- Tab Headers -->
                            <div class="tab-container">
                                <button class="tab active" onclick="switchCallCenterTab('existing')" data-tab="existing">
                                    <i data-lucide="user-check" style="width: 1.25rem; height: 1.25rem;"></i>
                                    Create Job (Existing Customer)
                                </button>
                                <button class="tab" onclick="switchCallCenterTab('new')" data-tab="new">
                                    <i data-lucide="user-plus" style="width: 1.25rem; height: 1.25rem;"></i>
                                    Create New Customer
                                </button>
                            </div>

                            <!-- Existing Customer Tab Content -->
                            <div id="existing-customer-tab" class="tab-content active">
                                <div style="text-align: center; margin-bottom: 2rem;">
                                    <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">Create Job for Existing Customer</h3>
                                    <p style="color: #6b7280;">Quick job creation for established customers</p>
                                </div>

                                <!-- Customer Information -->
                                <div style="background: linear-gradient(45deg, #ecfdf5, #d1fae5); border: 1px solid #86efac; border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                                    <h4 style="color: var(--primary-black); font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                        <i data-lucide="building" style="width: 1.25rem; height: 1.25rem;"></i>
                                        Customer & Location Details
                                    </h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Customer Name <span style="color: #dc2626;">*</span></label>
                                            <input type="text" id="customer-name" class="form-input" placeholder="e.g., Snuffers Restaurant Group">
                                        </div>
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Service Location <span style="color: #dc2626;">*</span></label>
                                            <input type="text" id="service-location" class="form-input" placeholder="e.g., Snuffers - Rockwall">
                                        </div>
                                    </div>
                                </div>

                                <!-- Job Details -->
                                <div style="background: linear-gradient(45deg, #dbeafe, #e0e7ff); border: 1px solid #bfdbfe; border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                                    <h4 style="color: var(--primary-black); font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                                        <i data-lucide="wrench" style="width: 1.25rem; height: 1.25rem;"></i>
                                        Job Information
                                    </h4>
                                    <div style="display: grid; gap: 1rem;">
                                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                                            <div>
                                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Job Category <span style="color: #dc2626;">*</span></label>
                                                <select id="job-category" class="form-select">
                                                    <option value="">Select Category</option>
                                                    <option value="Refrigeration">Refrigeration</option>
                                                    <option value="HVAC">HVAC</option>
                                                    <option value="Plumbing">Plumbing</option>
                                                    <option value="Electrical">Electrical</option>
                                                    <option value="Kitchen Equipment">Kitchen Equipment</option>
                                                    <option value="Building Maintenance">Building Maintenance</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Job Priority <span style="color: #dc2626;">*</span></label>
                                                <select id="job-priority" class="form-select">
                                                    <option value="Emergency">Emergency</option>
                                                    <option value="High">High</option>
                                                    <option value="Normal" selected>Normal</option>
                                                    <option value="Low">Low</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Job Description <span style="color: #dc2626;">*</span></label>
                                            <textarea id="job-description" class="form-textarea" style="height: 6rem; resize: none;" placeholder="e.g., Freezer not maintaining temperature"></textarea>
                                        </div>
                                    </div>
                                </div>

                                <!-- Submit Button -->
                                <div style="text-align: center;">
                                    <button class="btn btn-success" onclick="createCallCenterJob()" style="width: auto; padding: 1rem 2rem; font-size: 1.125rem;">
                                        <i data-lucide="plus-circle" style="width: 1.5rem; height: 1.5rem;"></i>
                                        Create Job
                                    </button>
                                </div>
                            </div>

                            <!-- New Customer Tab Content -->
                            <div id="new-customer-tab" class="tab-content">
                                <div style="text-align: center; margin-bottom: 2rem;">
                                    <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">Create New Customer</h3>
                                    <p style="color: #6b7280;">Add a new customer to the system</p>
                                </div>

                                <!-- Customer Basic Info -->
                                <div style="background: linear-gradient(45deg, #faf5ff, #fce7f3); border: 1px solid #e9d5ff; border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                                    <h4 style="color: var(--primary-black); font-weight: 600; margin-bottom: 1rem;">Customer Information</h4>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Company Name <span style="color: #dc2626;">*</span></label>
                                            <input type="text" id="company-name" class="form-input" placeholder="Company or Business Name">
                                        </div>
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Contact Person <span style="color: #dc2626;">*</span></label>
                                            <input type="text" id="contact-person" class="form-input" placeholder="Primary Contact Name">
                                        </div>
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Phone Number <span style="color: #dc2626;">*</span></label>
                                            <input type="tel" id="phone-number" class="form-input" placeholder="(555) 123-4567">
                                        </div>
                                        <div>
                                            <label style="display: block; font-weight: 600; margin-bottom: 0.5rem; color: var(--primary-black);">Email <span style="color: #dc2626;">*</span></label>
                                            <input type="email" id="email" class="form-input" placeholder="contact@company.com">
                                        </div>
                                    </div>
                                </div>

                                <!-- Submit Button -->
                                <div style="text-align: center;">
                                    <button class="btn btn-primary" onclick="createNewCustomer()" style="width: auto; padding: 1rem 2rem; font-size: 1.125rem;">
                                        <i data-lucide="user-plus" style="width: 1.5rem; height: 1.5rem;"></i>
                                        Create New Customer
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Status Content -->
                <div id="system-status-content" class="content-panel hidden">
                    <h2 style="margin-bottom: 2rem; color: var(--primary-black); font-size: 2rem; font-weight: 700; padding: 2rem 2rem 0;">System Status & API Connections</h2>
                    
                    <div class="status-grid">
                        <!-- Field Service APIs -->
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">Field Service APIs</h3>
                                <div class="status-icon connected">
                                    <i data-lucide="wifi" style="width: 20px; height: 20px;"></i>
                                </div>
                            </div>
                            <div class="status-details">
                                <div class="status-item">
                                    <span class="status-label">Service Fusion</span>
                                    <span class="status-value connected">Connected</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Service Titan</span>
                                    <span class="status-value warning">Pending</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Roopairs</span>
                                    <span class="status-value disconnected">Disconnected</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Last Sync</span>
                                    <span class="status-value">2 min ago</span>
                                </div>
                            </div>
                        </div>

                        <!-- Work Order APIs -->
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">Work Order APIs</h3>
                                <div class="status-icon connected">
                                    <i data-lucide="database" style="width: 20px; height: 20px;"></i>
                                </div>
                            </div>
                            <div class="status-details">
                                <div class="status-item">
                                    <span class="status-label">Ecotrak</span>
                                    <span class="status-value connected">Connected</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Service Channel</span>
                                    <span class="status-value disconnected">Disconnected</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Corrigo</span>
                                    <span class="status-value disconnected">Disconnected</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Last Sync</span>
                                    <span class="status-value">5 min ago</span>
                                </div>
                            </div>
                        </div>

                        <!-- Warranty System -->
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">Warranty System</h3>
                                <div class="status-icon connected">
                                    <i data-lucide="shield-check" style="width: 20px; height: 20px;"></i>
                                </div>
                            </div>
                            <div class="status-details">
                                <div class="status-item">
                                    <span class="status-label">Portal Status</span>
                                    <span class="status-value connected">Online</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">PDF Processing</span>
                                    <span class="status-value connected">Active</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Active Companies</span>
                                    <span class="status-value">5</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Queue Status</span>
                                    <span class="status-value">3 pending</span>
                                </div>
                            </div>
                        </div>

                        <!-- Call Center System -->
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">Call Center System</h3>
                                <div class="status-icon connected">
                                    <i data-lucide="phone" style="width: 20px; height: 20px;"></i>
                                </div>
                            </div>
                            <div class="status-details">
                                <div class="status-item">
                                    <span class="status-label">Agent Portal</span>
                                    <span class="status-value connected">Online</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">API Integration</span>
                                    <span class="status-value connected">Connected</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Active Sessions</span>
                                    <span class="status-value">12</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Response Time</span>
                                    <span class="status-value">245ms</span>
                                </div>
                            </div>
                        </div>

                        <!-- Overall System Health -->
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">System Health</h3>
                                <div class="status-icon connected">
                                    <i data-lucide="heart" style="width: 20px; height: 20px;"></i>
                                </div>
                            </div>
                            <div class="status-details">
                                <div class="status-item">
                                    <span class="status-label">Overall Status</span>
                                    <span class="status-value connected">Healthy</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Uptime</span>
                                    <span class="status-value">99.8%</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">CPU Usage</span>
                                    <span class="status-value">23%</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Memory Usage</span>
                                    <span class="status-value">45%</span>
                                </div>
                            </div>
                        </div>

                        <!-- Database Status -->
                        <div class="status-card">
                            <div class="status-header">
                                <h3 class="status-title">Database Status</h3>
                                <div class="status-icon connected">
                                    <i data-lucide="server" style="width: 20px; height: 20px;"></i>
                                </div>
                            </div>
                            <div class="status-details">
                                <div class="status-item">
                                    <span class="status-label">Primary DB</span>
                                    <span class="status-value connected">Online</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Backup DB</span>
                                    <span class="status-value connected">Synced</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Query Time</span>
                                    <span class="status-value">12ms</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Connections</span>
                                    <span class="status-value">45/100</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Provider Modal -->
    <div id="provider-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="color: var(--primary-white); font-weight: 700; margin: 0;">Add New Warranty Provider</h2>
                <button class="modal-close" onclick="closeProviderModal()">
                    <i data-lucide="x" style="width: 1.5rem; height: 1.5rem;"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="provider-form">
                    <!-- Company Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="building" style="width: 1.25rem; height: 1.25rem;"></i>
                            Company Information
                        </h3>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Company Name <span class="required">*</span></label>
                                <input type="text" id="provider-name" class="form-input" placeholder="Enter company name" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Account Number <span class="required">*</span></label>
                                <input type="text" id="provider-account" class="form-input" placeholder="Enter account number" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Business Address <span class="required">*</span></label>
                            <textarea id="provider-address" class="form-textarea" placeholder="Enter complete business address" required style="height: 80px; resize: vertical;"></textarea>
                        </div>
                    </div>

                    <!-- Contact Information Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="user-check" style="width: 1.25rem; height: 1.25rem;"></i>
                            Primary Contact Information
                        </h3>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Contact Person <span class="required">*</span></label>
                                <input type="text" id="contact-person-modal" class="form-input" placeholder="Enter contact person name" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Email Address <span class="required">*</span></label>
                                <input type="email" id="contact-email" class="form-input" placeholder="contact@company.com" required>
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Phone Number <span class="required">*</span></label>
                                <input type="tel" id="contact-phone" class="form-input" placeholder="(555) 123-4567" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Job Title</label>
                                <input type="text" id="contact-title" class="form-input" placeholder="e.g., Operations Manager">
                            </div>
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="paperclip" style="width: 1.25rem; height: 1.25rem;"></i>
                            Documentation
                        </h3>
                        
                        <div class="file-upload-area" id="file-upload-area">
                            <input type="file" id="provider-files" class="file-input" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                            <div class="file-upload-content">
                                <i data-lucide="upload-cloud" style="width: 3rem; height: 3rem; color: var(--primary-blue); margin-bottom: 1rem;"></i>
                                <p style="font-weight: 600; margin-bottom: 0.5rem;">Click to upload files or drag and drop</p>
                                <p style="color: #6b7280; font-size: 0.9rem;">PDF, DOC, DOCX, JPG, PNG (Max 10MB each)</p>
                            </div>
                        </div>
                        
                        <div id="file-list" class="file-list"></div>
                    </div>

                    <!-- Generated Credentials Section -->
                    <div class="form-section">
                        <h3 class="section-title">
                            <i data-lucide="key" style="width: 1.25rem; height: 1.25rem;"></i>
                            Portal Access Credentials
                        </h3>
                        
                        <div class="credentials-box">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label class="form-label">Generated Username</label>
                                    <div class="input-group">
                                        <input type="text" id="generated-username" class="form-input" readonly>
                                        <button type="button" class="btn-icon" onclick="generateCredentials()" title="Generate new credentials">
                                            <i data-lucide="refresh-cw" style="width: 1rem; height: 1rem;"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Generated Password</label>
                                    <div class="input-group">
                                        <input type="password" id="generated-password" class="form-input" readonly>
                                        <button type="button" class="btn-icon" onclick="togglePasswordVisibility()" title="Show/hide password">
                                            <i data-lucide="eye" id="password-toggle-icon" style="width: 1rem; height: 1rem;"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 1rem;">
                                <label class="checkbox-container">
                                    <input type="checkbox" id="send-credentials" checked>
                                    <span class="checkmark"></span>
                                    Send credentials to contact email automatically
                                </label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-outline" onclick="closeProviderModal()">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="createProvider()">
                    <i data-lucide="check-circle" style="width: 1rem; height: 1rem;"></i>
                    Create Provider
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global Application State
        let currentModule = 'welcome';
        let currentFieldServiceProvider = 'servicefusion';
        let currentWorkOrderProvider = 'ecotrak';
        let selectedWarrantyCompany = null;
        let systemStats = {
            totalTickets: 247,
            activeJobs: 18,
            completionRate: 94.2,
            systemUptime: 99.8
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeLucide();
            updateStats();
            setInterval(updateStats, 30000);
            setActiveMenuItem('welcome');
            initializeCallCenterInfo();
            console.log('Field Service Management Platform initialized');
        });

        function initializeLucide() {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
                console.log('Lucide icons initialized');
            } else {
                setTimeout(initializeLucide, 100);
            }
        }

        function initializeCallCenterInfo() {
            const now = new Date();
            const operatorId = 'OP-' + Math.random().toString(36).substr(2, 6).toUpperCase();
            const sessionId = 'SS-' + Date.now().toString().substr(-6);
            
            if (document.getElementById('operator-id')) {
                document.getElementById('operator-id').textContent = operatorId;
                document.getElementById('session-id').textContent = sessionId;
                document.getElementById('current-date').textContent = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
            }
        }

        // Navigation Functions
        function loadContent(contentType) {
            console.log('Loading content:', contentType);
            hideAllContent();
            setActiveMenuItem(contentType);
            currentModule = contentType;
            
            switch(contentType) {
                case 'field-service':
                    document.getElementById('field-service-content').classList.remove('hidden');
                    initializeCallCenterInfo();
                    break;
                case 'work-order':
                    document.getElementById('work-order-content').classList.remove('hidden');
                    break;
                case 'warranty':
                    document.getElementById('warranty-content').classList.remove('hidden');
                    break;
                case 'call-center':
                    document.getElementById('call-center-content').classList.remove('hidden');
                    initializeCallCenterInfo();
                    break;
                case 'system-status':
                    document.getElementById('system-status-content').classList.remove('hidden');
                    refreshSystemStatus();
                    break;
                default:
                    showWelcome();
                    break;
            }
            
            // Re-initialize icons for new content
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function setActiveMenuItem(contentType) {
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[data-content="${contentType}"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }

        function hideAllContent() {
            document.getElementById('welcome-content').classList.add('hidden');
            document.getElementById('field-service-content').classList.add('hidden');
            document.getElementById('work-order-content').classList.add('hidden');
            document.getElementById('warranty-content').classList.add('hidden');
            document.getElementById('call-center-content').classList.add('hidden');
            document.getElementById('system-status-content').classList.add('hidden');
        }

        function showWelcome() {
            hideAllContent();
            document.getElementById('welcome-content').classList.remove('hidden');
            setActiveMenuItem('welcome');
        }

        // Field Service Management Functions
        function selectFieldServiceProvider(provider) {
            console.log('Selecting field service provider:', provider);
            currentFieldServiceProvider = provider;
            
            // Update provider cards
            document.querySelectorAll('#field-service-content .provider-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`[data-provider="${provider}"]`).classList.add('active');
            
            // Update configuration panel
            updateFieldServiceConfig(provider);
            showNotification(`Selected ${provider} for configuration`, 'info');
        }

        function updateFieldServiceConfig(provider) {
            const configs = {
                servicefusion: {
                    name: 'Service Fusion',
                    connected: true,
                    url: 'https://api.servicefusion.com/v1'
                },
                servicetitan: {
                    name: 'Service Titan',
                    connected: false,
                    url: 'https://api.servicetitan.com/v2'
                },
                roopairs: {
                    name: 'Roopairs',
                    connected: false,
                    url: 'https://api.roopairs.com/v1'
                }
            };

            const config = configs[provider];
            if (config) {
                document.getElementById('fs-config-title').textContent = `${config.name} Integration Configuration`;
                document.getElementById('fs-config-status').textContent = config.connected ? '● Connected' : '● Disconnected';
                document.getElementById('fs-config-status').className = config.connected ? 
                    'status-connected' : 'status-disconnected';
                document.getElementById('fs-base-url').value = config.url;
                document.getElementById('fs-api-key').value = config.connected ? '***************' : '';
            }
        }

        function testFieldServiceConnection() {
            showNotification('Testing field service connection...', 'info');
            setTimeout(() => {
                const success = Math.random() > 0.2;
                if (success) {
                    showNotification('Connection test successful!', 'success');
                } else {
                    showNotification('Connection test failed. Please check your credentials.', 'error');
                }
            }, 2000);
        }

        function saveFieldServiceConfig() {
            showNotification('Saving field service configuration...', 'info');
            setTimeout(() => {
                showNotification('Configuration saved successfully!', 'success');
                document.getElementById('fs-config-status').textContent = '● Connected';
                document.getElementById('fs-config-status').className = 'status-connected';
            }, 1500);
        }

        function syncFieldServiceNow() {
            showNotification('Starting field service sync...', 'info');
            setTimeout(() => {
                const processed = Math.floor(Math.random() * 20) + 10;
                showNotification(`Sync completed! Processed ${processed} work orders.`, 'success');
                systemStats.totalTickets += processed;
                updateStats();
            }, 3000);
        }

        function viewFieldServiceLogs() {
            showNotification('Opening field service logs...', 'info');
        }

        // Work Order Integration Functions
        function selectWorkOrderProvider(provider) {
            console.log('Selecting work order provider:', provider);
            currentWorkOrderProvider = provider;
            
            document.querySelectorAll('#work-order-content .provider-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`#work-order-content [data-provider="${provider}"]`).classList.add('active');
            
            updateWorkOrderConfig(provider);
            showNotification(`Selected ${provider} for configuration`, 'info');
        }

        function updateWorkOrderConfig(provider) {
            const configs = {
                ecotrak: {
                    name: 'Ecotrak',
                    connected: true,
                    url: 'https://api.ecotrak.com/v1'
                },
                servicechannel: {
                    name: 'Service Channel',
                    connected: false,
                    url: 'https://api.servicechannel.com/v1'
                },
                corrigo: {
                    name: 'Corrigo',
                    connected: false,
                    url: 'https://api.corrigo.com/v1'
                }
            };

            const config = configs[provider];
            if (config) {
                document.getElementById('wo-config-title').textContent = `${config.name} Integration Configuration`;
                document.getElementById('wo-config-status').textContent = config.connected ? '● Connected' : '● Disconnected';
                document.getElementById('wo-base-url').value = config.url;
                document.getElementById('wo-api-key').value = config.connected ? '***************' : '';
            }
        }

        function testWorkOrderConnection() {
            showNotification('Testing work order connection...', 'info');
            setTimeout(() => {
                const success = Math.random() > 0.2;
                if (success) {
                    showNotification('Connection test successful!', 'success');
                } else {
                    showNotification('Connection test failed. Please check your credentials.', 'error');
                }
            }, 2000);
        }

        function saveWorkOrderConfig() {
            showNotification('Saving work order configuration...', 'info');
            setTimeout(() => {
                showNotification('Configuration saved successfully!', 'success');
            }, 1500);
        }

        function syncWorkOrderNow() {
            showNotification('Starting work order sync...', 'info');
            setTimeout(() => {
                const processed = Math.floor(Math.random() * 15) + 5;
                showNotification(`Sync completed! Processed ${processed} work orders.`, 'success');
            }, 3000);
        }

        function viewWorkOrderLogs() {
            showNotification('Opening work order logs...', 'info');
        }

        // Warranty Processing Functions
        function selectWarrantyCompany(company) {
            console.log('Selecting warranty company:', company);
            selectedWarrantyCompany = company;
            
            document.querySelectorAll('#warranty-content .provider-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`#warranty-content [data-company="${company}"]`).classList.add('active');
            
            const actionsPanel = document.getElementById('warranty-actions');
            const companyNames = {
                newco: 'NewCo Warranty',
                nsc: 'NSC',
                true: 'True',
                spaceman: 'SpaceMan',
                dukers: 'Dukers Warranty'
            };
            
            document.getElementById('selected-company-name').textContent = `${companyNames[company]} Portal`;
            actionsPanel.style.display = 'block';
            
            showNotification(`Selected ${companyNames[company]} portal`, 'info');
        }

        // Add Provider Modal Functions
        function openProviderModal() {
            document.getElementById('provider-modal').style.display = 'flex';
            generateCredentials();
            initializeFileUpload();
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function closeProviderModal() {
            document.getElementById('provider-modal').style.display = 'none';
            resetProviderForm();
        }

        function resetProviderForm() {
            document.getElementById('provider-form').reset();
            document.getElementById('file-list').innerHTML = '';
            document.getElementById('generated-username').value = '';
            document.getElementById('generated-password').value = '';
            document.getElementById('password-toggle-icon').setAttribute('data-lucide', 'eye');
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        // Credential Generation Functions
        function generateCredentials() {
            const companyName = document.getElementById('provider-name').value || 'Company';
            const timestamp = Date.now().toString().substr(-4);
            
            const initials = companyName.split(' ')
                .map(word => word.charAt(0).toUpperCase())
                .join('')
                .substr(0, 3);
            const username = initials + timestamp;
            
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%&*';
            let password = '';
            for (let i = 0; i < 12; i++) {
                password += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            document.getElementById('generated-username').value = username;
            document.getElementById('generated-password').value = password;
        }

        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('generated-password');
            const toggleIcon = document.getElementById('password-toggle-icon');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.setAttribute('data-lucide', 'eye-off');
            } else {
                passwordInput.type = 'password';
                toggleIcon.setAttribute('data-lucide', 'eye');
            }
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        // File Upload Functions
        function initializeFileUpload() {
            const uploadArea = document.getElementById('file-upload-area');
            const fileInput = document.getElementById('provider-files');
            const fileList = document.getElementById('file-list');
            
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                handleFiles(files);
            });
            
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', function(e) {
                handleFiles(e.target.files);
            });
        }

        function handleFiles(files) {
            const fileList = document.getElementById('file-list');
            
            Array.from(files).forEach(file => {
                if (file.size > 10 * 1024 * 1024) {
                    showNotification(`File ${file.name} exceeds 10MB limit`, 'error');
                    return;
                }
                
                const fileItem = createFileItem(file);
                fileList.appendChild(fileItem);
            });
        }

        function createFileItem(file) {
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            
            const formatFileSize = (bytes) => {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            };
            
            const getFileIcon = (fileName) => {
                const ext = fileName.split('.').pop().toLowerCase();
                switch (ext) {
                    case 'pdf': return 'file-text';
                    case 'doc':
                    case 'docx': return 'file-text';
                    case 'jpg':
                    case 'jpeg':
                    case 'png': return 'image';
                    default: return 'file';
                }
            };
            
            fileItem.innerHTML = `
                <div class="file-info">
                    <i data-lucide="${getFileIcon(file.name)}" class="file-icon" style="width: 1.5rem; height: 1.5rem;"></i>
                    <div class="file-details">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${formatFileSize(file.size)}</div>
                    </div>
                </div>
                <button type="button" class="file-remove" onclick="removeFile(this)" title="Remove file">
                    <i data-lucide="trash-2" style="width: 1rem; height: 1rem;"></i>
                </button>
            `;
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
            
            return fileItem;
        }

        function removeFile(button) {
            button.closest('.file-item').remove();
        }

        // Provider Creation Function
        function createProvider() {
            const requiredFields = [
                'provider-name',
                'provider-account',
                'provider-address',
                'contact-person-modal',
                'contact-email',
                'contact-phone'
            ];
            
            let isValid = true;
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.style.borderColor = '#ef4444';
                    isValid = false;
                } else {
                    field.style.borderColor = '#d1d5db';
                }
            });
            
            if (!isValid) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            const emailField = document.getElementById('contact-email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(emailField.value)) {
                showNotification('Please enter a valid email address', 'error');
                emailField.style.borderColor = '#ef4444';
                return;
            }
            
            const username = document.getElementById('generated-username').value;
            const password = document.getElementById('generated-password').value;
            
            if (!username || !password) {
                showNotification('Please generate credentials before creating the provider', 'error');
                return;
            }
            
            showNotification('Creating warranty provider...', 'info');
            
            setTimeout(() => {
                const providerData = {
                    name: document.getElementById('provider-name').value,
                    account: document.getElementById('provider-account').value,
                    address: document.getElementById('provider-address').value,
                    contactPerson: document.getElementById('contact-person-modal').value,
                    contactEmail: document.getElementById('contact-email').value,
                    contactPhone: document.getElementById('contact-phone').value,
                    contactTitle: document.getElementById('contact-title').value,
                    username: username,
                    password: password,
                    sendCredentials: document.getElementById('send-credentials').checked
                };
                
                addNewProviderCard(providerData);
                
                if (providerData.sendCredentials) {
                    sendCredentialsEmail(providerData);
                }
                
                showNotification(`Provider "${providerData.name}" created successfully!`, 'success');
                closeProviderModal();
                
            }, 2000);
        }

        function addNewProviderCard(providerData) {
            const warrantyGrid = document.querySelector('#warranty-content .provider-card').parentNode;
            const providerId = providerData.name.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]/g, '');
            
            const gradients = [
                'linear-gradient(45deg, #6366f1, #8b5cf6)',
                'linear-gradient(45deg, #06b6d4, #3b82f6)',
                'linear-gradient(45deg, #10b981, #059669)',
                'linear-gradient(45deg, #f59e0b, #d97706)',
                'linear-gradient(45deg, #ef4444, #dc2626)'
            ];
            const randomGradient = gradients[Math.floor(Math.random() * gradients.length)];
            
            const newCard = document.createElement('div');
            newCard.className = 'provider-card';
            newCard.setAttribute('data-company', providerId);
            newCard.onclick = function() { selectWarrantyCompany(providerId); };
            
            newCard.innerHTML = `
                <div style="display: inline-flex; align-items: center; justify-content: center; width: 4rem; height: 4rem; background: ${randomGradient}; border-radius: 1rem; margin-bottom: 1.5rem;">
                    <i data-lucide="shield-check" style="width: 2rem; height: 2rem; color: white;"></i>
                </div>
                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--primary-black); margin-bottom: 0.5rem;">${providerData.name}</h3>
                <p style="color: #6b7280; font-size: 0.9rem; margin-bottom: 1rem;">Click to access portal</p>
                <div style="background: #f8fafc; border-radius: 12px; padding: 1rem;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                        <div>
                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Work Orders</p>
                            <p style="font-weight: 700; color: var(--primary-black);">0</p>
                        </div>
                        <div>
                            <p style="color: #6b7280; margin-bottom: 0.25rem;">Active</p>
                            <p style="font-weight: 700; color: var(--primary-black);">0</p>
                        </div>
                    </div>
                </div>
            `;
            
            const actionsPanel = document.getElementById('warranty-actions');
            warrantyGrid.insertBefore(newCard, actionsPanel);
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function sendCredentialsEmail(providerData) {
            setTimeout(() => {
                showNotification(`Login credentials sent to ${providerData.contactEmail}`, 'success');
            }, 3000);
        }

        function createWorkOrder() {
            showNotification('Opening work order creation form...', 'info');
            setTimeout(() => {
                const woId = 'WO-' + Date.now().toString().substr(-6);
                showNotification(`Work order ${woId} created successfully!`, 'success');
                systemStats.activeJobs++;
                updateStats();
            }, 2000);
        }

        function uploadPDF() {
            showNotification('Opening PDF upload interface...', 'info');
        }

        function viewWorkOrders() {
            showNotification('Loading work orders list...', 'info');
        }

        // Call Center Functions
        function switchCallCenterTab(tabType) {
            console.log('Switching to tab:', tabType);
            
            document.querySelectorAll('#call-center-content .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`#call-center-content [data-tab="${tabType}"]`).classList.add('active');
            
            document.querySelectorAll('#call-center-content .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            if (tabType === 'existing') {
                document.getElementById('existing-customer-tab').classList.add('active');
            } else {
                document.getElementById('new-customer-tab').classList.add('active');
            }
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function createCallCenterJob() {
            const customerName = document.getElementById('customer-name').value;
            const serviceLocation = document.getElementById('service-location').value;
            const jobCategory = document.getElementById('job-category').value;
            const jobPriority = document.getElementById('job-priority').value;
            const jobDescription = document.getElementById('job-description').value;

            if (!customerName || !serviceLocation || !jobCategory || !jobDescription) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            showNotification('Creating job from call center...', 'info');
            setTimeout(() => {
                const jobId = 'JOB-' + Date.now().toString().substr(-6);
                showNotification(`Job ${jobId} created successfully for ${customerName}!`, 'success');
                systemStats.totalTickets++;
                systemStats.activeJobs++;
                updateStats();
                
                document.getElementById('customer-name').value = '';
                document.getElementById('service-location').value = '';
                document.getElementById('job-category').value = '';
                document.getElementById('job-priority').value = 'Normal';
                document.getElementById('job-description').value = '';
            }, 2000);
        }

        function createNewCustomer() {
            const companyName = document.getElementById('company-name').value;
            const contactPerson = document.getElementById('contact-person').value;
            const phoneNumber = document.getElementById('phone-number').value;
            const email = document.getElementById('email').value;

            if (!companyName || !contactPerson || !phoneNumber || !email) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            showNotification('Creating new customer...', 'info');
            setTimeout(() => {
                const customerId = 'CUST-' + Date.now().toString().substr(-6);
                showNotification(`Customer ${customerId} created successfully for ${companyName}!`, 'success');
                
                document.getElementById('company-name').value = '';
                document.getElementById('contact-person').value = '';
                document.getElementById('phone-number').value = '';
                document.getElementById('email').value = '';
            }, 2000);
        }

        // Utility Functions
        function updateStats() {
            systemStats.totalTickets += Math.floor(Math.random() * 3);
            systemStats.activeJobs = Math.max(10, systemStats.activeJobs + Math.floor(Math.random() * 3) - 1);
            systemStats.completionRate = Math.min(100, Math.max(85, systemStats.completionRate + (Math.random() - 0.5)));
            systemStats.systemUptime = Math.min(100, Math.max(95, systemStats.systemUptime + (Math.random() - 0.5) * 0.1));
            
            if (document.getElementById('total-tickets')) {
                document.getElementById('total-tickets').textContent = systemStats.totalTickets;
                document.getElementById('active-jobs').textContent = systemStats.activeJobs;
                document.getElementById('completion-rate').textContent = systemStats.completionRate.toFixed(1) + '%';
                document.getElementById('system-uptime').textContent = systemStats.systemUptime.toFixed(1) + '%';
            }
        }

        function refreshSystemStatus() {
            console.log('Refreshing system status...');
            showNotification('System status refreshed successfully', 'success');
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        function logout() {
            showNotification('Logging out...', 'info');
            setTimeout(() => {
                alert('Demo logout complete. In production, this would redirect to the login page.');
            }, 1500);
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            
            let backgroundColor;
            switch (type) {
                case 'error':
                    backgroundColor = '#ef4444';
                    break;
                case 'info':
                    backgroundColor = '#59ACE1';
                    break;
                case 'warning':
                    backgroundColor = '#FFB100';
                    break;
                default:
                    backgroundColor = '#10b981';
            }
            
            notification.style.cssText = `
                position: fixed;
                top: 90px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                z-index: 10000;
                animation: slideIn 0.3s ease;
                max-width: 400px;
                font-weight: 500;
                font-family: Georgia Pro, Georgia, serif;
                line-height: 1.4;
                cursor: pointer;
            `;
            notification.textContent = message;
            
            notification.onclick = () => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            };
            
            document.body.appendChild(notification);
            
            const duration = type === 'info' ? 4000 : 3000;
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, duration);
        }

        console.log('Field Service Management Platform ready - All systems operational');
    </script>
</body>
</html>